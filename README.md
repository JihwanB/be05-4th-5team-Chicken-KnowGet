# <p align="center">be05-4th-5team-Chicken-KnowGet</p>


<p align="center">
  ✨ 백지환 서근엽 정유진 정민지 ✨
  Chicken team 의 KnowGet 프로젝트
</p>

<p align="center">
  <img src="https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/93907076/d5dcb02c-1b8c-4ed2-8a55-7da4547e2604"/>
</p>

## 🏡 프로젝트 소개

1. :rocket: 목적 : <br/> <br/>
          "KnowGet"은 "Knowledge"와 "Get"이라는 두 단어를 결합한 합성어로, 지식을 얻는 과정을 즐겁고 손쉽게 만들어주는 웹 서비스이다.<br/>
          사용자들은 서로에게 질문을 하고 다양한 주제에 대해 답변을 제공함으로써 상호 소통하고 지식을 공유할 수 있다.<br/>
          이 웹서비스를 통해 사용자들은 다른 사람들의 경험과 지식을 공유하며 더욱 풍부한 정보를 얻을 수 있다.<br/>
          <br/> <br/>
          
2. :memo: 구현 기능 : <br/> <br/>
   2 - 1) 회원 가입, 로그인 인증 <br/>
   2 - 2) Q&A 게시판 <br/>
   2 - 3) 댓글 <br/>
<br/>

### ⚙️개발 기간

* 2024.04.24(수) ~ 2024.05.08(수) <br/> <br/> <br/>


## 🛠️ 기술 스택
<div align="center">
  <img src="https://img.shields.io/badge/java-007396?style=for-the-badge&logo=java&logoColor=white">
  <img src="https://img.shields.io/badge/Spring-6DB33F?style=for-the-badge&logo=Spring&logoColor=white">
  <img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white">
  <img src="https://img.shields.io/badge/Spring Security-6DB33F?style=for-the-badge&logo=Spring Security&logoColor=white">
</div>

<div align="center">
  <img src="https://img.shields.io/badge/JWT-black?style=for-the-badge&logo=JSON%20web%20tokens">
  <img src="https://img.shields.io/badge/HTML5-E34F26?style=for-the-badge&logo=HTML5&logoColor=white">
  <img src="https://img.shields.io/badge/CSS3-1572B6?style=for-the-badge&logo=CSS3&logoColor=white">
  <img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=JavaScript&logoColor=white">
  <img src="https://img.shields.io/badge/vue.js-4FC08D?style=for-the-badge&logo=vue.js&logoColor=white">
</div>

<div align="center">
  <img src="https://img.shields.io/badge/mariaDB-003545?style=for-the-badge&logo=mariaDB&logoColor=white">
  <img src="https://img.shields.io/badge/IntelliJ IDEA-000000.svg?style=for-the-badge&logo=intellij-idea&logoColor=white">
  <img src="https://img.shields.io/badge/Visual%20Studio%20Code-0078d7.svg?style=for-the-badge&logo=visual-studio-code&logoColor=white">
</div>

<div align="center">
  <img src="https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white">
  <img src="https://img.shields.io/badge/jenkins-%232C5263.svg?style=for-the-badge&logo=jenkins&logoColor=white">
  <img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
  <img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
</div>

## :bug: 팀 소개
<table>
  <tbody>
    <tr>
      <td align="center"><a href="https://github.com/JihwanB"><img src="https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/93907076/c4905936-8bb2-4241-a8db-870dafea5246"
 width="200px;" height="200px;" alt=""/><br /><sub><b>백지환</b></sub></a><br /></td>
      <td align="center"><a href="https://github.com/WARDKEY"><img src="https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/93907076/a113a005-4b55-4edc-b96d-ae61e2da53eb"
 width="200px;" height="200px" alt=""/><br /><sub><b>서근엽</b></sub></a><br /></td>
      <td align="center"><a href="https://github.com/mjjung2"><img src="https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/93907076/2db0b40b-2e5f-460b-9dd6-cfb34042e15b" width="200px;" height="200px;" alt=""/><br /><sub><b>정민지</b></sub></a><br /></td>
      <td align="center"><a href="https://github.com/eujin99"><img src="https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/93907076/9cbcfff6-3848-4b29-9ced-3cb3ee70fcbc" width="200px;" height="200px;" alt=""/><br /><sub><b>정유진</b></sub></a><br /></td>
    </tr>
  </tbody>
</table>
<br/><br/>

<br/>
<br/>

## 📦 디렉토리 구조 ( FrontEnd / BackEnd  )

1 ) :pushpin: FrontEnd 디렉토리 구조

```
knowget
├─ .gitignore
├─ babel.config.js
├─ jsconfig.json
├─ package-lock.json
├─ package.json
├─ public
│  ├─ favicon.ico
│  └─ index.html
├─ README.md
├─ src
│  ├─ App.vue
│  ├─ assets
│  │  └─ logo.png
│  ├─ components
│  │  └─ HelloWorld.vue
│  ├─ main.js
│  ├─ router
│  │  └─ index.js
│  ├─ store
│  │  └─ index.js
│  └─ views
│     ├─ AboutView.vue
│     ├─ HomeView.vue
│     ├─ QnADetail.vue
│     ├─ QnAList.vue
│     ├─ QnAWrite.vue
│     ├─ SignUp.vue
│     └─ UserLogin.vue
└─ vue.config.js

```

2 ) :pushpin: BackEnd 디렉토리 구조


```
KnowGet
├─ .git
│  ├─ config
│  ├─ description
│  ├─ FETCH_HEAD
│  ├─ HEAD
│  ├─ hooks
│  │  ├─ applypatch-msg.sample
│  │  ├─ commit-msg.sample
│  │  ├─ fsmonitor-watchman.sample
│  │  ├─ post-update.sample
│  │  ├─ pre-applypatch.sample
│  │  ├─ pre-commit.sample
│  │  ├─ pre-merge-commit.sample
│  │  ├─ pre-push.sample
│  │  ├─ pre-rebase.sample
│  │  ├─ pre-receive.sample
│  │  ├─ prepare-commit-msg.sample
│  │  ├─ push-to-checkout.sample
│  │  ├─ sendemail-validate.sample
│  │  └─ update.sample
│  ├─ info
│  │  └─ exclude
│  ├─ objects
│  │  ├─ info
│  │  └─ pack
│  └─ refs
│     ├─ heads
│     └─ tags
├─ .gitignore
├─ gradle
│  └─ wrapper
│     ├─ gradle-wrapper.jar
│     └─ gradle-wrapper.properties
├─ gradlew
├─ gradlew.bat
└─ src
   ├─ main
   │  ├─ java
   │  │  └─ com
   │  │     └─ knowget
   │  │        └─ knowget
   │  │           ├─ domain
   │  │           │  ├─ comment
   │  │           │  │  ├─ controller
   │  │           │  │  │  └─ CommentController.java
   │  │           │  │  ├─ dto
   │  │           │  │  │  ├─ CommentDeleteDto.java
   │  │           │  │  │  ├─ CommentRequestDto.java
   │  │           │  │  │  ├─ CommentResponseDto.java
   │  │           │  │  │  └─ CommentUpdateDto.java
   │  │           │  │  ├─ repository
   │  │           │  │  │  └─ CommentRepository.java
   │  │           │  │  └─ service
   │  │           │  │     ├─ CommentService.java
   │  │           │  │     └─ CommentServiceImpl.java
   │  │           │  ├─ likes
   │  │           │  │  ├─ controller
   │  │           │  │  │  └─ empty.file
   │  │           │  │  ├─ dto
   │  │           │  │  │  └─ empty.file
   │  │           │  │  ├─ repository
   │  │           │  │  │  └─ empty.file
   │  │           │  │  └─ service
   │  │           │  │     └─ empty.file
   │  │           │  ├─ post
   │  │           │  │  ├─ controller
   │  │           │  │  │  └─ QnaController.java
   │  │           │  │  ├─ dto
   │  │           │  │  │  ├─ QnaModifyRequestDTO.java
   │  │           │  │  │  └─ QnaRequestDTO.java
   │  │           │  │  ├─ exception
   │  │           │  │  │  ├─ InvalidLoginException.java
   │  │           │  │  │  └─ QnaNotFoundException.java
   │  │           │  │  ├─ repository
   │  │           │  │  │  └─ PostRepository.java
   │  │           │  │  └─ service
   │  │           │  │     └─ QnaService.java
   │  │           │  └─ user
   │  │           │     ├─ controller
   │  │           │     │  ├─ MailController.java
   │  │           │     │  └─ UserController.java
   │  │           │     ├─ dto
   │  │           │     │  ├─ EmailCheckDTO.java
   │  │           │     │  ├─ EmailRequestDTO.java
   │  │           │     │  ├─ UserSignInDTO.java
   │  │           │     │  └─ UserSignUpDTO.java
   │  │           │     ├─ exception
   │  │           │     │  ├─ InvalidPasswordException.java
   │  │           │     │  └─ UserNotFoundException.java
   │  │           │     ├─ repository
   │  │           │     │  └─ UserRepository.java
   │  │           │     ├─ service
   │  │           │     │  ├─ MailService.java
   │  │           │     │  └─ UserService.java
   │  │           │     └─ SignInResponse.java
   │  │           ├─ global
   │  │           │  ├─ common
   │  │           │  │  └─ BaseTime.java
   │  │           │  ├─ config
   │  │           │  │  ├─ email
   │  │           │  │  │  └─ EmailConfig.java
   │  │           │  │  ├─ redis
   │  │           │  │  │  └─ RedisUtil.java
   │  │           │  │  ├─ security
   │  │           │  │  │  ├─ JwtAuthenticationFilter.java
   │  │           │  │  │  ├─ SecurityConfig.java
   │  │           │  │  │  └─ TokenProvider.java
   │  │           │  │  └─ swagger
   │  │           │  │     └─ SwaggerConfig.java
   │  │           │  └─ entity
   │  │           │     ├─ Comment.java
   │  │           │     ├─ Likes.java
   │  │           │     ├─ Post.java
   │  │           │     └─ User.java
   │  │           └─ KnowGetApplication.java
   │  ├─ resources
   │  │  ├─ application.properties
   │  │  ├─ jwt.yml
   │  │  └─ templates
   │  │     └─ empty.file
   │  └─ webapp
   │     └─ WEB-INF
   │        └─ views
   │           └─ empty.file
   └─ test
      └─ java
         └─ com
            └─ knowget
               └─ knowget
                  └─ KnowGetApplicationTests.java

```


<br/>

## :globe_with_meridians: ERD
![ERD](https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/155809042/eabf7700-9951-4cfd-b16e-eb8dc076e981)

## :memo: WBS
[ WBS ](https://docs.google.com/spreadsheets/d/1c2KiFvD5wSIaPKdhtbI_LOJN7vkrVptiZ7Lq6WQYQkA/edit#gid=1834290736)

![WBS_KnowGet](https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/155809042/c282f9f1-5366-4313-9225-fa426e9057be)

## :rotating_light: 요구사항 명세서
[ 요구사항 명세서 ](https://docs.google.com/spreadsheets/d/1c2KiFvD5wSIaPKdhtbI_LOJN7vkrVptiZ7Lq6WQYQkA/edit#gid=1834290736)

![요구사항 명세서_KnowGet](https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/155809042/9002e2ee-02b4-4795-be4e-c59058564d18)

## :bulb: API 명세서

[ API 명세서 ](https://docs.google.com/spreadsheets/d/1c2KiFvD5wSIaPKdhtbI_LOJN7vkrVptiZ7Lq6WQYQkA/edit#gid=359725514)

![API명세서_KnowGet](https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/155809042/e7a80c59-46e4-4e80-ab93-d5831a6691ea)

<br/>
<br/>

## 📦 CI / CD 아키텍쳐
![IMG_0004](https://github.com/beyond-sw-camp/be05-4th-5team-Chicken-KnowGet/assets/155809042/2551783e-8931-4612-8d04-db3aadf5baf9)

## BackEnd

## Dockerfile

```
FROM openjdk:17-alpine

# jar파일을 만들고
ARG JAR_FILE=build/libs/*.jar

# jar파일을 copy, jar는 자바의 실행 파일
COPY ${JAR_FILE} backend.jar

# jar파일 실행할 때 사용
ENTRYPOINT ["java","-jar","/backend.jar"]
```

<br/>

## docker-compose.yaml

```
# backend, mariadb

version: "3"

services:
  # springboot
  # - 배열 형식
  app:
    container_name: chicken_knowget_backend
    build: .
    image: wardkey/chicken_knowget_backend:latest
    depends_on:
      - database
    ports:
      - "8080:8080"

    environment:
      SPRING_DATASOURCE_URL: jdbc:mariadb://database:3306/knowget?useUnicode=true
      SPRING_DATASOURCE_USERNAME: root
      SPRING_DATASOURCE_PASSWORD: root

    # 서버 실행하다 문제 생기면 다시 시작
    restart: always
    links:
      - database
    #    platform: linux/arm64 맥 호환성 추가

  # mariadb
  database:
    image: mariadb:10.6.16
    container_name: chicken_knowgetdb
    environment:
      MARIADB_ROOT_PASSWORD: root
#      MARIADB_USER: root
#      MARIADB_PASSWORD: root
      MARIADB_DATABASE: knowget

    # port를 변경하고 application.yaml에서도 포트 번호를 맞춤
    ports:
      - "6033:3306"

    volumes:
      - ./src/main/resources/database/initdb.d/:/docker-entrypoint-initdb.d/
```

</br>

## 1-schema.sql

```
# create schema knowget collate utf8mb4_general_ci;

# create database knowget;

use knowget;

create table users
(
    user_idx  bigint auto_increment
        primary key,
    delete_yn bit default b'0' null,
    email     varchar(255)     not null,
    id        varchar(255)     not null,
    name      varchar(255)     not null,
    password  varchar(255)     not null,
    phone     varchar(255)     null,
    constraint UK_6dotkott2kjsp8vw4d0m25fb7
        unique (email),
    constraint UK_6jvqtxgs6xvh0h0t261hurgqo
        unique (id),
    constraint UK_du5v5sr43g5bfnji4vb8hg5s3
        unique (phone)
);

create table post
(
    post_idx      bigint auto_increment
        primary key,
    written_time  datetime(6)  null,
    modified_time datetime(6)  null,
    content       text         not null,
    title         varchar(255) not null,
    type          varchar(255) not null,
    user_idx      bigint       not null,
    constraint FKgbu4s4d7g7gjqw2uks2krksoo
        foreign key (user_idx) references knowget.users (user_idx)
);

create table comment
(
    comment_idx   bigint auto_increment
        primary key,
    written_time  datetime(6) null,
    modified_time datetime(6) null,
    content       text        not null,
    post_idx      bigint      not null,
    user_idx      bigint      not null,
    constraint FK4x0ed95d7btd26400uea2d7gt
        foreign key (post_idx) references knowget.post (post_idx),
    constraint FKayd6ry9svpxpvotcd7oxg5l7j
        foreign key (user_idx) references knowget.users (user_idx)
);
```

</br>

## 2-data.sql

```
INSERT INTO `users` ( `email`, `id`, `name`, `password`, `phone`) VALUES ( 'email@naver.com', 'ididid', 'name', '$2a$10$hbNEirOWcP4fVN16iDs.u.IR/NLv1PnJqVE8pF.gj33qrqPDHCbrq', '010-0000-0000');

INSERT INTO `post` (`content`, `title`, `type`, `user_idx`) VALUES ( 'ㅁㄴㅇ', 'ㅁㄴㅇ', 'qna', 1);

INSERT INTO `comment` (`content`, `post_idx`, `user_idx`) VALUES ('내용', 1, 1);
```

</br>

## Pipeline Script

```

pipeline {

	agent any

	stages{

		stage('Build') {
			steps {
            // git 연동
			git branch : 'main',
            credentialsId : 'githubtoken',
			url : 'https://github.com/WARDKEY/chicken_knowget_backend.git'
			bat './gradlew.bat build bootJAR'
			}
		}
		
 		stage('Jar Clean') {
 			steps {
 				bat './gradlew.bat clean bootJAR'
 			}
 	    }

		// Docker image 빌드
        stage('Build Dokcer Image') {
            steps {
                script {
                    docker.build('wardkey/chicken_knowget_backend')    
                }
                
            }
        }
        
        // Docker Hub 로그인
        stage('Push to Dokcer Hub') {
            steps {
                script {
                    docker.withRegistry('https://registry.hub.docker.com', 'dockertoken') {
                        docker.image('wardkey/chicken_knowget_backend').push()
                    }    
                }
                
            }
        }
        
        // Docker Compose 설정
        stage('Deploy with Docker Compose') {
            steps {
                script {
                    // docker compose 다운로드
                    // 실행 파일 다운로드
                    bat "curl -L https://github.com/docker/compose/releases/download/2.24.6/docker-compose-Linux-x86_64 -o docker-compose"	
                    // docker compose 설치
                    bat "icacls docker-compose /grant user:RX"
                    // docker compose up
                    bat ".\\docker-compose build"
                    bat ".\\docker-compose up -d"
                    
                }
            }
        }
    }
}
```

## FrontEnd

## Dockerfile

```
# 베이스 이미지
FROM node:20.12.2

# 클라우드 환경에서 디렉토리를 의미
WORKDIR /front-vue

# 현재 디렉토리에 있는 모든 파일을 WORKDIR로 이동
COPY . .

# 필요한 의존관계 라이브러리를 설치하는 명령어
RUN npm install
RUN npm i axios
RUN npm install vuex@next --save


# 포트번호 노출
EXPOSE 8081

# 스크립트 실행 명령어(하나의 도커파일은 하나의 CMD만 가짐, 배열 형식으로 지정)
CMD ["npm", "run", "serve"]
```

</br>

## Pipeline Script

```

pipeline {

	agent any

    environment{
        GIT_HUB_CREDENTIALS = credentials('githubtoken')
        DOCKER_HUB_CREDENTIALS = credentials('dockertoken')
        DOCKER_IMAGE_NAME = 'wardkey/chicken_knowget_frontend'
        DOCKER_IMAGE_TAG = '1.0'
    }
    
    

	stages{

		stage('Build') {
			steps {
            // git 연동\
			git branch : 'main',
			credentialsId : "${GIT_HUB_CREDENTIALS}",
			url : 'https://github.com/WARDKEY/chicken_knowget_frontend.git'
			}
		}
		
		// 필요한 파일 다운로드
		stage('Install Dependency') {  
		    steps {
		        bat 'npm install'
		    }
		}
		
	
				
		// 배포환경에서 사용할 파일 빌드
        stage('Npm Build') {
            steps {
                bat 'npm run build'
            }
        }
		
		// Docker image 빌드
        stage('Build Docker Image') {
		    steps {
		        script {    
		            docker.build("${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG}", "-f Dockerfile .")
		        }
		    }
		}
		
		// Docker hub에 push
		stage('Push to Dokcer-Hub') {
            steps {
                script {
                    docker.withRegistry('https://registry.hub.docker.com', 'dockertoken') {
                        docker.image("${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG}").push()
                    }    
                }
                
            }
        }
        
        stage('Run Container') {
            steps {
                script {
                    
                    // 이전에 실행되고 있는 컨테이너 제거
                    bat "docker ps -a"
                    bat "docker stop chicken_knowget_frontend || exit 0"
                    bat "docker rm chicken_knowget_frontend || exit 0"    
                    
                    
                    docker.withRegistry('https://registry.hub.docker.com', 'dockertoken') {
                        docker.image("${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG}").run('-d -p 8081:8081 --name chicken_knowget_frontend')
                    }    
                }
                
            }
        }
	}
}
```
